!function(a){"use strict";a(document).ready(function(){function b(){g.show().css("height",0),g.find(".wrap").css("opacity",1),g.stop(!0).animate({height:g.find(".project").outerHeight()},800,function(){g.css({height:"auto"})})}function c(){0!==g.height()&&(g.find(".wrap").stop(!0).animate({opacity:0},200),g.stop(!0).animate({height:0},600,function(){g.hide()}))}var d=a("#ajax-projects-feed"),e=a(".project"),f=a(".portfolio-filter").find("a"),g=a("#magic-door"),h=a("#header"),i=a("#loading");d.on("click",".project a",function(d){d.preventDefault(),history.pushState(null,null,this.href);var f=a(this);f.hasClass("active")||(i.fadeIn(200),e.children("a").removeClass("active"),f.addClass("active"),a.scrollTo(h,500),c(),setTimeout(function(){a.get(f.attr("href"),function(c){var d=a(c).find("#ajax-project-content");g.find(".wrap").html(d),picturefill(),a(".video").fitVids(),b(),i.fadeOut(200)})},300))}),a(window).on("popstate",function(){var f=history.location||document.location;if("/"!=f.pathname){var j=d.find('.project a[href="'+f.href+'"]');i.fadeIn(200),e.children("a").removeClass("active"),j.addClass("active"),a.scrollTo(h,500),c(),setTimeout(function(){a.get(f.href,function(c){var d=a(c).find("#ajax-project-content");g.find(".wrap").html(d),picturefill(),a(".video").fitVids(),b(),i.fadeOut(200)})},300)}else i.show(),c(),i.fadeOut(200)}),a("body").hasClass("is_home")&&f.on("click",function(b){b.preventDefault();var c=a(this),d=c.attr("href"),g="/tag/",h=d.lastIndexOf(g),i=d.slice(h+g.length);f.removeClass("active-filter-item"),c.addClass("active-filter-item"),-1===h?e.removeClass("hidden"):e.each(function(b,c){var d=a(c);d.hasClass(i)?d.removeClass("hidden"):d.addClass("hidden")})}),a(".video").fitVids()})}(window.jQuery);